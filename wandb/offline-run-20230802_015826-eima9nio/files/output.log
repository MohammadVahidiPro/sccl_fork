results path: results/SCCL.minilm6.SBERT.virtual.stackoverflow.text.lr1e-05.lrscale100.SCCL.eta10.tmp0.5.alpha1.0.seed42/
..... loading Sentence-BERT !!!
first-base: all_embeddings:(20000, 384), true_labels:20000, pred_labels:20000
first-base, Iterations:31, Clustering ACC:0.717, centers:(20, 384)
first-base kmeans repre scores: {'first-base/ACC': 0.7171, 'first-base/NMI': 0.6976716459573631, 'first-base/ARI': 0.555043695437533, 'first-base/AMI': 0.6967484569246016, 'first-base/avg': 0.7073858229786816}
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 1e-05
    maximize: False
    weight_decay: 0
Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)
 Initializing PairConLoss
*****Intialize SCCLv, temp:0.5, eta:10
########################################
=1000/50=Iterations/Batches
cannot access local variable 'train_loader_iter' where it is not associated with a value
Iter 0: [Representation]  scores:  {'ACC': 0.6936, 'NMI': 0.6974, 'ARI': 0.5135, 'AMI': 0.6965, 'avg': 0.6955}
Iter 0:          [Model]  scores:  {'ACC': 0.7169, 'NMI': 0.6972, 'ARI': 0.5557, 'AMI': 0.6963, 'avg': 0.7071}
###### new BEST step 0 ^^^ ######
Iter 25: [Representation]  scores:  {'ACC': 0.7149, 'NMI': 0.6942, 'ARI': 0.5512, 'AMI': 0.6933, 'avg': 0.7046}
Iter 25:          [Model]  scores:  {'ACC': 0.7137, 'NMI': 0.6939, 'ARI': 0.5475, 'AMI': 0.693, 'avg': 0.7038}
Iter 50: [Representation]  scores:  {'ACC': 0.7145, 'NMI': 0.6911, 'ARI': 0.5479, 'AMI': 0.6902, 'avg': 0.7028}
Iter 50:          [Model]  scores:  {'ACC': 0.7072, 'NMI': 0.6866, 'ARI': 0.533, 'AMI': 0.6857, 'avg': 0.6969}
Iter 75: [Representation]  scores:  {'ACC': 0.7126, 'NMI': 0.6872, 'ARI': 0.5428, 'AMI': 0.6863, 'avg': 0.6999}
Iter 75:          [Model]  scores:  {'ACC': 0.7043, 'NMI': 0.6828, 'ARI': 0.5265, 'AMI': 0.6818, 'avg': 0.6935}
Iter 100: [Representation]  scores:  {'ACC': 0.7123, 'NMI': 0.685, 'ARI': 0.5432, 'AMI': 0.684, 'avg': 0.6986}
Iter 100:          [Model]  scores:  {'ACC': 0.7028, 'NMI': 0.6797, 'ARI': 0.524, 'AMI': 0.6787, 'avg': 0.6913}
Iter 125: [Representation]  scores:  {'ACC': 0.7113, 'NMI': 0.6823, 'ARI': 0.5391, 'AMI': 0.6813, 'avg': 0.6968}
Iter 125:          [Model]  scores:  {'ACC': 0.7034, 'NMI': 0.6782, 'ARI': 0.5259, 'AMI': 0.6773, 'avg': 0.6908}
Iter 150: [Representation]  scores:  {'ACC': 0.7129, 'NMI': 0.6802, 'ARI': 0.5375, 'AMI': 0.6792, 'avg': 0.6965}
Iter 150:          [Model]  scores:  {'ACC': 0.7043, 'NMI': 0.6773, 'ARI': 0.5298, 'AMI': 0.6763, 'avg': 0.6908}
Iter 175: [Representation]  scores:  {'ACC': 0.6973, 'NMI': 0.6701, 'ARI': 0.5116, 'AMI': 0.6691, 'avg': 0.6837}
Iter 175:          [Model]  scores:  {'ACC': 0.7072, 'NMI': 0.6773, 'ARI': 0.5379, 'AMI': 0.6764, 'avg': 0.6923}
Iter 200: [Representation]  scores:  {'ACC': 0.7133, 'NMI': 0.6785, 'ARI': 0.536, 'AMI': 0.6775, 'avg': 0.6959}
Iter 200:          [Model]  scores:  {'ACC': 0.7082, 'NMI': 0.6754, 'ARI': 0.5407, 'AMI': 0.6744, 'avg': 0.6918}
Iter 225: [Representation]  scores:  {'ACC': 0.7117, 'NMI': 0.6767, 'ARI': 0.5327, 'AMI': 0.6757, 'avg': 0.6942}
Iter 225:          [Model]  scores:  {'ACC': 0.7097, 'NMI': 0.6745, 'ARI': 0.5445, 'AMI': 0.6735, 'avg': 0.6921}
Iter 250: [Representation]  scores:  {'ACC': 0.713, 'NMI': 0.6763, 'ARI': 0.5331, 'AMI': 0.6754, 'avg': 0.6947}
Iter 250:          [Model]  scores:  {'ACC': 0.7108, 'NMI': 0.671, 'ARI': 0.5476, 'AMI': 0.67, 'avg': 0.6909}
Iter 275: [Representation]  scores:  {'ACC': 0.7146, 'NMI': 0.6772, 'ARI': 0.5337, 'AMI': 0.6762, 'avg': 0.6959}
Iter 275:          [Model]  scores:  {'ACC': 0.7131, 'NMI': 0.6694, 'ARI': 0.5523, 'AMI': 0.6684, 'avg': 0.6912}
Iter 300: [Representation]  scores:  {'ACC': 0.7139, 'NMI': 0.6757, 'ARI': 0.5184, 'AMI': 0.6747, 'avg': 0.6948}
Iter 300:          [Model]  scores:  {'ACC': 0.714, 'NMI': 0.6676, 'ARI': 0.5552, 'AMI': 0.6666, 'avg': 0.6908}
Iter 325: [Representation]  scores:  {'ACC': 0.7147, 'NMI': 0.6755, 'ARI': 0.5191, 'AMI': 0.6745, 'avg': 0.6951}
Iter 325:          [Model]  scores:  {'ACC': 0.7145, 'NMI': 0.6652, 'ARI': 0.5572, 'AMI': 0.6642, 'avg': 0.6899}
Iter 350: [Representation]  scores:  {'ACC': 0.7114, 'NMI': 0.6754, 'ARI': 0.5139, 'AMI': 0.6744, 'avg': 0.6934}
Iter 350:          [Model]  scores:  {'ACC': 0.7138, 'NMI': 0.6614, 'ARI': 0.5573, 'AMI': 0.6604, 'avg': 0.6876}
Iter 375: [Representation]  scores:  {'ACC': 0.7207, 'NMI': 0.6792, 'ARI': 0.5222, 'AMI': 0.6782, 'avg': 0.7}
Iter 375:          [Model]  scores:  {'ACC': 0.7142, 'NMI': 0.6584, 'ARI': 0.5581, 'AMI': 0.6573, 'avg': 0.6863}
Iter 400: [Representation]  scores:  {'ACC': 0.7193, 'NMI': 0.6786, 'ARI': 0.5207, 'AMI': 0.6777, 'avg': 0.699}
Iter 400:          [Model]  scores:  {'ACC': 0.7156, 'NMI': 0.6568, 'ARI': 0.5599, 'AMI': 0.6558, 'avg': 0.6862}
Iter 425: [Representation]  scores:  {'ACC': 0.7208, 'NMI': 0.6778, 'ARI': 0.521, 'AMI': 0.6768, 'avg': 0.6993}
Iter 425:          [Model]  scores:  {'ACC': 0.7151, 'NMI': 0.6539, 'ARI': 0.5582, 'AMI': 0.6529, 'avg': 0.6845}
Iter 450: [Representation]  scores:  {'ACC': 0.7165, 'NMI': 0.6764, 'ARI': 0.5176, 'AMI': 0.6754, 'avg': 0.6964}
Iter 450:          [Model]  scores:  {'ACC': 0.7143, 'NMI': 0.6504, 'ARI': 0.5572, 'AMI': 0.6494, 'avg': 0.6823}
Iter 475: [Representation]  scores:  {'ACC': 0.72, 'NMI': 0.6781, 'ARI': 0.5206, 'AMI': 0.6771, 'avg': 0.6991}
Iter 475:          [Model]  scores:  {'ACC': 0.7138, 'NMI': 0.6472, 'ARI': 0.5558, 'AMI': 0.6461, 'avg': 0.6805}
Iter 500: [Representation]  scores:  {'ACC': 0.7187, 'NMI': 0.6771, 'ARI': 0.5186, 'AMI': 0.6761, 'avg': 0.6979}
Iter 500:          [Model]  scores:  {'ACC': 0.7136, 'NMI': 0.6447, 'ARI': 0.5544, 'AMI': 0.6437, 'avg': 0.6792}
Iter 525: [Representation]  scores:  {'ACC': 0.7202, 'NMI': 0.6782, 'ARI': 0.5195, 'AMI': 0.6772, 'avg': 0.6992}
Iter 525:          [Model]  scores:  {'ACC': 0.7136, 'NMI': 0.6431, 'ARI': 0.5525, 'AMI': 0.642, 'avg': 0.6783}
Iter 550: [Representation]  scores:  {'ACC': 0.7239, 'NMI': 0.6793, 'ARI': 0.5223, 'AMI': 0.6783, 'avg': 0.7016}
Iter 550:          [Model]  scores:  {'ACC': 0.7137, 'NMI': 0.642, 'ARI': 0.552, 'AMI': 0.6409, 'avg': 0.6779}
Iter 575: [Representation]  scores:  {'ACC': 0.7194, 'NMI': 0.678, 'ARI': 0.519, 'AMI': 0.677, 'avg': 0.6987}
Iter 575:          [Model]  scores:  {'ACC': 0.7127, 'NMI': 0.6393, 'ARI': 0.5494, 'AMI': 0.6382, 'avg': 0.676}
Iter 600: [Representation]  scores:  {'ACC': 0.7191, 'NMI': 0.6778, 'ARI': 0.519, 'AMI': 0.6768, 'avg': 0.6984}
Iter 600:          [Model]  scores:  {'ACC': 0.7117, 'NMI': 0.6375, 'ARI': 0.5474, 'AMI': 0.6364, 'avg': 0.6746}
Iter 625: [Representation]  scores:  {'ACC': 0.7185, 'NMI': 0.6766, 'ARI': 0.5177, 'AMI': 0.6756, 'avg': 0.6975}
Iter 625:          [Model]  scores:  {'ACC': 0.7127, 'NMI': 0.637, 'ARI': 0.5469, 'AMI': 0.6359, 'avg': 0.6748}
Iter 650: [Representation]  scores:  {'ACC': 0.7292, 'NMI': 0.683, 'ARI': 0.5303, 'AMI': 0.6821, 'avg': 0.7061}
Iter 650:          [Model]  scores:  {'ACC': 0.7112, 'NMI': 0.6345, 'ARI': 0.5442, 'AMI': 0.6334, 'avg': 0.6728}
Iter 675: [Representation]  scores:  {'ACC': 0.7177, 'NMI': 0.6746, 'ARI': 0.5158, 'AMI': 0.6736, 'avg': 0.6962}
Iter 675:          [Model]  scores:  {'ACC': 0.7102, 'NMI': 0.6331, 'ARI': 0.5419, 'AMI': 0.6319, 'avg': 0.6716}
Iter 700: [Representation]  scores:  {'ACC': 0.7288, 'NMI': 0.6786, 'ARI': 0.5388, 'AMI': 0.6776, 'avg': 0.7037}
Iter 700:          [Model]  scores:  {'ACC': 0.7094, 'NMI': 0.6318, 'ARI': 0.5404, 'AMI': 0.6307, 'avg': 0.6706}
Iter 725: [Representation]  scores:  {'ACC': 0.7209, 'NMI': 0.6762, 'ARI': 0.5186, 'AMI': 0.6752, 'avg': 0.6986}
Iter 725:          [Model]  scores:  {'ACC': 0.7095, 'NMI': 0.6315, 'ARI': 0.5395, 'AMI': 0.6303, 'avg': 0.6705}
Iter 750: [Representation]  scores:  {'ACC': 0.7225, 'NMI': 0.6764, 'ARI': 0.5179, 'AMI': 0.6754, 'avg': 0.6994}
Iter 750:          [Model]  scores:  {'ACC': 0.7086, 'NMI': 0.6303, 'ARI': 0.538, 'AMI': 0.6292, 'avg': 0.6694}
Iter 775: [Representation]  scores:  {'ACC': 0.7346, 'NMI': 0.6827, 'ARI': 0.54, 'AMI': 0.6817, 'avg': 0.7086}
Iter 775:          [Model]  scores:  {'ACC': 0.7073, 'NMI': 0.6279, 'ARI': 0.5353, 'AMI': 0.6268, 'avg': 0.6676}
Iter 800: [Representation]  scores:  {'ACC': 0.7205, 'NMI': 0.6751, 'ARI': 0.5172, 'AMI': 0.6741, 'avg': 0.6978}
Iter 800:          [Model]  scores:  {'ACC': 0.7066, 'NMI': 0.6268, 'ARI': 0.5335, 'AMI': 0.6257, 'avg': 0.6667}
Iter 825: [Representation]  scores:  {'ACC': 0.7178, 'NMI': 0.6737, 'ARI': 0.515, 'AMI': 0.6727, 'avg': 0.6957}
Iter 825:          [Model]  scores:  {'ACC': 0.7053, 'NMI': 0.6254, 'ARI': 0.5311, 'AMI': 0.6242, 'avg': 0.6653}
Iter 850: [Representation]  scores:  {'ACC': 0.7277, 'NMI': 0.6802, 'ARI': 0.5238, 'AMI': 0.6792, 'avg': 0.7039}
Iter 850:          [Model]  scores:  {'ACC': 0.704, 'NMI': 0.6237, 'ARI': 0.5291, 'AMI': 0.6225, 'avg': 0.6638}
Iter 875: [Representation]  scores:  {'ACC': 0.7179, 'NMI': 0.6731, 'ARI': 0.5143, 'AMI': 0.6721, 'avg': 0.6955}
Iter 875:          [Model]  scores:  {'ACC': 0.7036, 'NMI': 0.6228, 'ARI': 0.5284, 'AMI': 0.6217, 'avg': 0.6632}
Iter 900: [Representation]  scores:  {'ACC': 0.7341, 'NMI': 0.6923, 'ARI': 0.5222, 'AMI': 0.6914, 'avg': 0.7132}
Iter 900:          [Model]  scores:  {'ACC': 0.7035, 'NMI': 0.6228, 'ARI': 0.528, 'AMI': 0.6217, 'avg': 0.6631}
Iter 925: [Representation]  scores:  {'ACC': 0.718, 'NMI': 0.673, 'ARI': 0.5146, 'AMI': 0.672, 'avg': 0.6955}
Iter 925:          [Model]  scores:  {'ACC': 0.7032, 'NMI': 0.6231, 'ARI': 0.5283, 'AMI': 0.622, 'avg': 0.6631}
Iter 950: [Representation]  scores:  {'ACC': 0.7308, 'NMI': 0.6801, 'ARI': 0.522, 'AMI': 0.6791, 'avg': 0.7054}
Iter 950:          [Model]  scores:  {'ACC': 0.7007, 'NMI': 0.6215, 'ARI': 0.5247, 'AMI': 0.6203, 'avg': 0.6611}
Iter 975: [Representation]  scores:  {'ACC': 0.7072, 'NMI': 0.6769, 'ARI': 0.5108, 'AMI': 0.6759, 'avg': 0.692}
Iter 975:          [Model]  scores:  {'ACC': 0.6986, 'NMI': 0.6207, 'ARI': 0.5226, 'AMI': 0.6196, 'avg': 0.6597}
Iter 1000: [Representation]  scores:  {'ACC': 0.7067, 'NMI': 0.6763, 'ARI': 0.5109, 'AMI': 0.6753, 'avg': 0.6915}
Iter 1000:          [Model]  scores:  {'ACC': 0.698, 'NMI': 0.6195, 'ARI': 0.5214, 'AMI': 0.6184, 'avg': 0.6587}
last-base: all_embeddings:(20000, 384), true_labels:20000, pred_labels:20000
last-base, Iterations:95, Clustering ACC:0.727, centers:(20, 384)
##### the final kmeans repre scores:  {'last-base/ACC': 0.7272, 'last-base/NMI': 0.6778646674369078, 'last-base/ARI': 0.5151235370492406, 'last-base/AMI': 0.6768750921737279, 'last-base/avg': 0.7025323337184539}